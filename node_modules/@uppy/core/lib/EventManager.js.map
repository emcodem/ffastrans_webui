{"version":3,"names":["EventManager","constructor","uppy","Object","defineProperty","_uppy","writable","value","_events","_classPrivateFieldLooseBase","on","event","fn","push","remove","splice","off","onFilePause","fileID","cb","file","isPaused","id","onFileRemove","onPause","onRetry","onRetryAll","getFile","onPauseAll","onCancelAll","eventHandler","_this","arguments","onResumeAll"],"sources":["EventManager.ts"],"sourcesContent":["import type { Meta, Body, UppyFile } from '@uppy/utils/lib/UppyFile'\nimport type { Uppy, UppyEventMap, _UppyEventMap } from './Uppy.ts'\n\n/**\n * Create a wrapper around an event emitter with a `remove` method to remove\n * all events that were added using the wrapped emitter.\n */\nexport default class EventManager<M extends Meta, B extends Body> {\n  #uppy: Uppy<M, B>\n\n  #events: Array<[keyof UppyEventMap<M, B>, (...args: any[]) => void]> = []\n\n  constructor(uppy: Uppy<M, B>) {\n    this.#uppy = uppy\n  }\n\n  on<K extends keyof _UppyEventMap<M, B>>(\n    event: K,\n    fn: _UppyEventMap<M, B>[K],\n  ): Uppy<M, B>\n\n  on<K extends keyof UppyEventMap<M, B>>(\n    event: K,\n    fn: UppyEventMap<M, B>[K],\n  ): Uppy<M, B> {\n    this.#events.push([event, fn])\n    return this.#uppy.on(event as keyof _UppyEventMap<M, B>, fn)\n  }\n\n  remove(): void {\n    for (const [event, fn] of this.#events.splice(0)) {\n      this.#uppy.off(event, fn)\n    }\n  }\n\n  onFilePause(\n    fileID: UppyFile<M, B>['id'],\n    cb: (isPaused: boolean) => void,\n  ): void {\n    this.on('upload-pause', (file, isPaused) => {\n      if (fileID === file?.id) {\n        cb(isPaused)\n      }\n    })\n  }\n\n  onFileRemove(\n    fileID: UppyFile<M, B>['id'],\n    cb: (isPaused: UppyFile<M, B>['id']) => void,\n  ): void {\n    this.on('file-removed', (file) => {\n      if (fileID === file.id) cb(file.id)\n    })\n  }\n\n  onPause(fileID: UppyFile<M, B>['id'], cb: (isPaused: boolean) => void): void {\n    this.on('upload-pause', (file, isPaused) => {\n      if (fileID === file?.id) {\n        // const isPaused = this.#uppy.pauseResume(fileID)\n        cb(isPaused)\n      }\n    })\n  }\n\n  onRetry(fileID: UppyFile<M, B>['id'], cb: () => void): void {\n    this.on('upload-retry', (file) => {\n      if (fileID === file?.id) {\n        cb()\n      }\n    })\n  }\n\n  onRetryAll(fileID: UppyFile<M, B>['id'], cb: () => void): void {\n    this.on('retry-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n\n  onPauseAll(fileID: UppyFile<M, B>['id'], cb: () => void): void {\n    this.on('pause-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n\n  onCancelAll(\n    fileID: UppyFile<M, B>['id'],\n    eventHandler: UppyEventMap<M, B>['cancel-all'],\n  ): void {\n    this.on('cancel-all', (...args) => {\n      if (!this.#uppy.getFile(fileID)) return\n      eventHandler(...args)\n    })\n  }\n\n  onResumeAll(fileID: UppyFile<M, B>['id'], cb: () => void): void {\n    this.on('resume-all', () => {\n      if (!this.#uppy.getFile(fileID)) return\n      cb()\n    })\n  }\n}\n"],"mappings":"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","ignoreList":[]}