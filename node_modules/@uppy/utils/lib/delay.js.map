{"version":3,"names":["createAbortError","delay","ms","opts","Promise","resolve","reject","_opts$signal","_opts$signal2","signal","aborted","timeout","setTimeout","cleanup","onabort","clearTimeout","addEventListener","_opts$signal3","removeEventListener","undefined"],"sources":["delay.ts"],"sourcesContent":["import { createAbortError } from './AbortController.ts'\n\n/**\n * Return a Promise that resolves after `ms` milliseconds.\n */\nexport default function delay(\n  ms: number,\n  opts?: { signal: AbortSignal },\n): Promise<void> {\n  return new Promise((resolve, reject) => {\n    if (opts?.signal?.aborted) {\n      return reject(createAbortError())\n    }\n\n    const timeout = setTimeout(() => {\n      cleanup() // eslint-disable-line no-use-before-define\n      resolve()\n    }, ms)\n\n    function onabort(): void {\n      clearTimeout(timeout)\n      cleanup() // eslint-disable-line no-use-before-define\n      reject(createAbortError())\n    }\n    opts?.signal?.addEventListener('abort', onabort)\n    function cleanup(): void {\n      opts?.signal?.removeEventListener('abort', onabort)\n    }\n    return undefined\n  })\n}\n"],"mappings":"AAAA,SAASA,gBAAgB,QAAQ,sBAAsB;;AAEvD;AACA;AACA;AACA,eAAe,SAASC,KAAKA,CAC3BC,EAAU,EACVC,IAA8B,EACf;EACf,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IAAA,IAAAC,YAAA,EAAAC,aAAA;IACtC,IAAIL,IAAI,aAAAI,YAAA,GAAJJ,IAAI,CAAEM,MAAM,aAAZF,YAAA,CAAcG,OAAO,EAAE;MACzB,OAAOJ,MAAM,CAACN,gBAAgB,CAAC,CAAC,CAAC;IACnC;IAEA,MAAMW,OAAO,GAAGC,UAAU,CAAC,MAAM;MAC/BC,OAAO,CAAC,CAAC,EAAC;MACVR,OAAO,CAAC,CAAC;IACX,CAAC,EAAEH,EAAE,CAAC;IAEN,SAASY,OAAOA,CAAA,EAAS;MACvBC,YAAY,CAACJ,OAAO,CAAC;MACrBE,OAAO,CAAC,CAAC,EAAC;MACVP,MAAM,CAACN,gBAAgB,CAAC,CAAC,CAAC;IAC5B;IACAG,IAAI,aAAAK,aAAA,GAAJL,IAAI,CAAEM,MAAM,aAAZD,aAAA,CAAcQ,gBAAgB,CAAC,OAAO,EAAEF,OAAO,CAAC;IAChD,SAASD,OAAOA,CAAA,EAAS;MAAA,IAAAI,aAAA;MACvBd,IAAI,aAAAc,aAAA,GAAJd,IAAI,CAAEM,MAAM,aAAZQ,aAAA,CAAcC,mBAAmB,CAAC,OAAO,EAAEJ,OAAO,CAAC;IACrD;IACA,OAAOK,SAAS;EAClB,CAAC,CAAC;AACJ","ignoreList":[]}