{"version":3,"names":["h","classNames","remoteFileObjToLocal","SearchInput","Browser","packageJson","PartialTreeUtils","shouldHandleScroll","handleError","getClickedRange","FooterActions","addFiles","getCheckedFilesWithPaths","defaultState","loading","searchString","partialTree","type","id","cached","nextPagePath","currentFolderId","isInputMode","SearchProviderView","constructor","plugin","opts","isHandlingScroll","lastCheckbox","validateSingleFile","file","companionFile","result","uppy","getDisplayedPartialTree","getPluginState","filter","item","setSearchString","setPluginState","validateAggregateRestrictions","checkedFiles","status","uppyFiles","map","data","provider","defaultOptions","viewType","showTitles","showFilter","bind","search","resetPluginState","handleScroll","donePicking","cancelSelection","toggleCheckbox","render","on","registerRequestClient","tearDown","setLoading","newPartialTree","response","nextPageQuery","items","requestPath","parentId","error","event","root","find","i","newRoot","oldItems","companionFiles","ourItem","isShiftKeyPressed","clickedRange","afterToggleCheckbox","state","viewOptions","i18n","submitSearchString","inputLabel","buttonLabel","wrapperClassName","inputClassName","showButton","buttonCSSClassName","className","clearSearchLabel","displayedPartialTree","openFolder","noResultsLabel","isLoading","virtualList","VERSION","version"],"sources":["SearchProviderView.tsx"],"sourcesContent":["import { h } from 'preact'\n\nimport type { Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type {\n  PartialTree,\n  PartialTreeFile,\n  PartialTreeFolderNode,\n  PartialTreeFolderRoot,\n  UnknownSearchProviderPlugin,\n  UnknownSearchProviderPluginState,\n} from '@uppy/core/lib/Uppy.js'\nimport type { CompanionFile } from '@uppy/utils/lib/CompanionFile'\nimport classNames from 'classnames'\nimport type { ValidateableFile } from '@uppy/core/lib/Restricter.js'\nimport remoteFileObjToLocal from '@uppy/utils/lib/remoteFileObjToLocal'\nimport SearchInput from '../SearchInput.tsx'\nimport Browser from '../Browser.tsx'\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nimport packageJson from '../../package.json'\nimport PartialTreeUtils from '../utils/PartialTreeUtils/index.ts'\nimport shouldHandleScroll from '../utils/shouldHandleScroll.ts'\nimport handleError from '../utils/handleError.ts'\nimport getClickedRange from '../utils/getClickedRange.ts'\nimport FooterActions from '../FooterActions.tsx'\nimport addFiles from '../utils/addFiles.ts'\nimport getCheckedFilesWithPaths from '../utils/PartialTreeUtils/getCheckedFilesWithPaths.ts'\n\nconst defaultState: UnknownSearchProviderPluginState = {\n  loading: false,\n  searchString: '',\n  partialTree: [\n    {\n      type: 'root',\n      id: null,\n      cached: false,\n      nextPagePath: null,\n    },\n  ],\n  currentFolderId: null,\n  isInputMode: true,\n}\n\ntype Optional<T, K extends keyof T> = Pick<Partial<T>, K> & Omit<T, K>\n\ninterface Opts<M extends Meta, B extends Body> {\n  provider: UnknownSearchProviderPlugin<M, B>['provider']\n  viewType: 'list' | 'grid' | 'unsplash'\n  showTitles: boolean\n  showFilter: boolean\n}\ntype PassedOpts<M extends Meta, B extends Body> = Optional<\n  Opts<M, B>,\n  'viewType' | 'showTitles' | 'showFilter'\n>\ntype DefaultOpts<M extends Meta, B extends Body> = Omit<Opts<M, B>, 'provider'>\ntype RenderOpts<M extends Meta, B extends Body> = Omit<\n  PassedOpts<M, B>,\n  'provider'\n>\n\ntype Res = {\n  items: CompanionFile[]\n  nextPageQuery: string | null\n  searchedFor: string\n}\n\n/**\n * SearchProviderView, used for Unsplash and future image search providers.\n * Extends generic View, shared with regular providers like Google Drive and Instagram.\n */\nexport default class SearchProviderView<M extends Meta, B extends Body> {\n  static VERSION = packageJson.version\n\n  plugin: UnknownSearchProviderPlugin<M, B>\n\n  provider: UnknownSearchProviderPlugin<M, B>['provider']\n\n  opts: Opts<M, B>\n\n  isHandlingScroll: boolean = false\n\n  lastCheckbox: string | null = null\n\n  constructor(\n    plugin: UnknownSearchProviderPlugin<M, B>,\n    opts: PassedOpts<M, B>,\n  ) {\n    this.plugin = plugin\n    this.provider = opts.provider\n    const defaultOptions: DefaultOpts<M, B> = {\n      viewType: 'grid',\n      showTitles: true,\n      showFilter: true,\n    }\n    this.opts = { ...defaultOptions, ...opts }\n\n    this.setSearchString = this.setSearchString.bind(this)\n    this.search = this.search.bind(this)\n    this.resetPluginState = this.resetPluginState.bind(this)\n    this.handleScroll = this.handleScroll.bind(this)\n    this.donePicking = this.donePicking.bind(this)\n    this.cancelSelection = this.cancelSelection.bind(this)\n    this.toggleCheckbox = this.toggleCheckbox.bind(this)\n\n    this.render = this.render.bind(this)\n\n    // Set default state for the plugin\n    this.resetPluginState()\n\n    // @ts-expect-error this should be typed in @uppy/dashboard.\n    this.plugin.uppy.on('dashboard:close-panel', this.resetPluginState)\n\n    this.plugin.uppy.registerRequestClient(\n      this.provider.provider,\n      this.provider,\n    )\n  }\n\n  // eslint-disable-next-line class-methods-use-this\n  tearDown(): void {\n    // Nothing.\n  }\n\n  setLoading(loading: boolean | string): void {\n    this.plugin.setPluginState({ loading })\n  }\n\n  resetPluginState(): void {\n    this.plugin.setPluginState(defaultState)\n  }\n\n  cancelSelection(): void {\n    const { partialTree } = this.plugin.getPluginState()\n    const newPartialTree: PartialTree = partialTree.map((item) =>\n      item.type === 'root' ? item : { ...item, status: 'unchecked' },\n    )\n    this.plugin.setPluginState({ partialTree: newPartialTree })\n  }\n\n  async search(): Promise<void> {\n    const { searchString } = this.plugin.getPluginState()\n    if (searchString === '') return\n\n    this.setLoading(true)\n    try {\n      const response = await this.provider.search<Res>(searchString)\n\n      const newPartialTree: PartialTree = [\n        {\n          type: 'root',\n          id: null,\n          cached: false,\n          nextPagePath: response.nextPageQuery,\n        },\n        ...response.items.map(\n          (item) =>\n            ({\n              type: 'file',\n              id: item.requestPath,\n              status: 'unchecked',\n              parentId: null,\n              data: item,\n            }) as PartialTreeFile,\n        ),\n      ]\n      this.plugin.setPluginState({\n        partialTree: newPartialTree,\n        isInputMode: false,\n      })\n    } catch (error) {\n      handleError(this.plugin.uppy)(error)\n    }\n    this.setLoading(false)\n  }\n\n  async handleScroll(event: Event): Promise<void> {\n    const { partialTree, searchString } = this.plugin.getPluginState()\n    const root = partialTree.find(\n      (i) => i.type === 'root',\n    ) as PartialTreeFolderRoot\n\n    if (\n      shouldHandleScroll(event) &&\n      !this.isHandlingScroll &&\n      root.nextPagePath\n    ) {\n      this.isHandlingScroll = true\n      try {\n        const response = await this.provider.search<Res>(\n          searchString,\n          root.nextPagePath,\n        )\n\n        const newRoot: PartialTreeFolderRoot = {\n          ...root,\n          nextPagePath: response.nextPageQuery,\n        }\n        const oldItems = partialTree.filter((i) => i.type !== 'root')\n\n        const newPartialTree: PartialTree = [\n          newRoot,\n          ...oldItems,\n          ...response.items.map(\n            (item) =>\n              ({\n                type: 'file',\n                id: item.requestPath,\n                status: 'unchecked',\n                parentId: null,\n                data: item,\n              }) as PartialTreeFile,\n          ),\n        ]\n        this.plugin.setPluginState({ partialTree: newPartialTree })\n      } catch (error) {\n        handleError(this.plugin.uppy)(error)\n      }\n      this.isHandlingScroll = false\n    }\n  }\n\n  async donePicking(): Promise<void> {\n    const { partialTree } = this.plugin.getPluginState()\n\n    // 1. Add files\n    const companionFiles = getCheckedFilesWithPaths(partialTree)\n    addFiles(companionFiles, this.plugin, this.provider)\n\n    // 2. Reset state\n    this.resetPluginState()\n  }\n\n  toggleCheckbox(\n    ourItem: PartialTreeFolderNode | PartialTreeFile,\n    isShiftKeyPressed: boolean,\n  ) {\n    const { partialTree } = this.plugin.getPluginState()\n\n    const clickedRange = getClickedRange(\n      ourItem.id,\n      this.getDisplayedPartialTree(),\n      isShiftKeyPressed,\n      this.lastCheckbox,\n    )\n    const newPartialTree = PartialTreeUtils.afterToggleCheckbox(\n      partialTree,\n      clickedRange,\n    )\n\n    this.plugin.setPluginState({ partialTree: newPartialTree })\n    this.lastCheckbox = ourItem.id\n  }\n\n  validateSingleFile = (file: CompanionFile): string | null => {\n    const companionFile: ValidateableFile<M, B> = remoteFileObjToLocal(file)\n    const result = this.plugin.uppy.validateSingleFile(companionFile)\n    return result\n  }\n\n  getDisplayedPartialTree = (): (PartialTreeFile | PartialTreeFolderNode)[] => {\n    const { partialTree } = this.plugin.getPluginState()\n    return partialTree.filter((item) => item.type !== 'root') as (\n      | PartialTreeFolderNode\n      | PartialTreeFile\n    )[]\n  }\n\n  setSearchString = (searchString: string) => {\n    this.plugin.setPluginState({ searchString })\n    if (searchString === '') {\n      this.plugin.setPluginState({ partialTree: [] })\n    }\n  }\n\n  validateAggregateRestrictions = (partialTree: PartialTree) => {\n    const checkedFiles = partialTree.filter(\n      (item) => item.type === 'file' && item.status === 'checked',\n    ) as PartialTreeFile[]\n    const uppyFiles = checkedFiles.map((file) => file.data)\n    return this.plugin.uppy.validateAggregateRestrictions(uppyFiles)\n  }\n\n  render(state: unknown, viewOptions: RenderOpts<M, B> = {}): h.JSX.Element {\n    const { isInputMode, searchString, loading, partialTree } =\n      this.plugin.getPluginState()\n    const { i18n } = this.plugin.uppy\n    const opts: Opts<M, B> = { ...this.opts, ...viewOptions }\n\n    if (isInputMode) {\n      return (\n        <SearchInput\n          searchString={searchString}\n          setSearchString={this.setSearchString}\n          submitSearchString={this.search}\n          inputLabel={i18n('enterTextToSearch')}\n          buttonLabel={i18n('searchImages')}\n          wrapperClassName=\"uppy-SearchProvider\"\n          inputClassName=\"uppy-c-textInput uppy-SearchProvider-input\"\n          showButton\n          buttonCSSClassName=\"uppy-SearchProvider-searchButton\"\n        />\n      )\n    }\n\n    return (\n      <div\n        className={classNames(\n          'uppy-ProviderBrowser',\n          `uppy-ProviderBrowser-viewType--${opts.viewType}`,\n        )}\n      >\n        {opts.showFilter && (\n          <SearchInput\n            searchString={searchString}\n            setSearchString={this.setSearchString}\n            submitSearchString={this.search}\n            inputLabel={i18n('search')}\n            clearSearchLabel={i18n('resetSearch')}\n            wrapperClassName=\"uppy-ProviderBrowser-searchFilter\"\n            inputClassName=\"uppy-ProviderBrowser-searchFilterInput\"\n          />\n        )}\n\n        <Browser\n          toggleCheckbox={this.toggleCheckbox}\n          displayedPartialTree={this.getDisplayedPartialTree()}\n          handleScroll={this.handleScroll}\n          openFolder={async () => {}}\n          noResultsLabel={i18n('noSearchResults')}\n          viewType={opts.viewType}\n          showTitles={opts.showTitles}\n          isLoading={loading}\n          i18n={i18n}\n          virtualList={false}\n        />\n\n        <FooterActions\n          partialTree={partialTree}\n          donePicking={this.donePicking}\n          cancelSelection={this.cancelSelection}\n          i18n={i18n}\n          validateAggregateRestrictions={this.validateAggregateRestrictions}\n        />\n      </div>\n    )\n  }\n}\n"],"mappings":"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","ignoreList":[]}