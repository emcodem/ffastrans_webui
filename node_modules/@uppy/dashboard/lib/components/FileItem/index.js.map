{"version":3,"names":["h","Component","classNames","shallowEqualObjects","FilePreviewAndLink","FileProgress","FileInfo","Buttons","FileItem","componentDidMount","file","props","preview","handleRequestThumbnail","shouldComponentUpdate","nextProps","componentDidUpdate","componentWillUnmount","handleCancelThumbnail","render","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isGhost","showRemoveButton","individualCancellation","showRemoveButtonAfterComplete","dashboardItemClass","recoveredState","resumableUploads","className","id","role","showLinkToFileUploadResult","i18n","toggleFileCard","metaFields","uppy","hideRetryButton","hideCancelButton","hidePauseResumeButton","containerWidth","containerHeight","toggleAddFilesPanel","isSingleFile","canEditFile","openFileEditor"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable react/destructuring-assignment */\nimport { h, Component, type ComponentChild } from 'preact'\nimport classNames from 'classnames'\nimport { shallowEqualObjects } from 'shallow-equal'\nimport type { UppyFile, Body, Meta } from '@uppy/utils/lib/UppyFile'\nimport type { I18n } from '@uppy/utils/lib/Translator'\nimport type Uppy from '@uppy/core'\nimport type { State } from '@uppy/core'\nimport FilePreviewAndLink from './FilePreviewAndLink/index.tsx'\nimport FileProgress from './FileProgress/index.tsx'\nimport FileInfo from './FileInfo/index.tsx'\nimport Buttons from './Buttons/index.tsx'\nimport type { DashboardState } from '../../Dashboard.ts'\n\ntype Props<M extends Meta, B extends Body> = {\n  file: UppyFile<M, B>\n  handleRequestThumbnail: (file: UppyFile<M, B>) => void\n  handleCancelThumbnail: (file: UppyFile<M, B>) => void\n  individualCancellation: boolean\n  showRemoveButtonAfterComplete: boolean\n  recoveredState: State<M, B>['recoveredState']\n  resumableUploads: boolean\n  i18n: I18n\n  role: string\n  showLinkToFileUploadResult: boolean\n  toggleFileCard: (show: boolean, fileId: string) => void\n  metaFields: DashboardState<M, B>['metaFields']\n  id: string\n  containerWidth: number\n  containerHeight: number\n  toggleAddFilesPanel: (show: boolean) => void\n  isSingleFile: boolean\n  hideRetryButton: boolean\n  hideCancelButton: boolean\n  hidePauseResumeButton: boolean\n  canEditFile: (file: UppyFile<M, B>) => boolean\n  openFileEditor: (file: UppyFile<M, B>) => void\n  uppy: Uppy<M, B>\n}\n\nexport default class FileItem<M extends Meta, B extends Body> extends Component<\n  Props<M, B>\n> {\n  componentDidMount(): void {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  shouldComponentUpdate(nextProps: Props<M, B>): boolean {\n    return !shallowEqualObjects(this.props, nextProps)\n  }\n\n  // VirtualList mounts FileItems again and they emit `thumbnail:request`\n  // Otherwise thumbnails are broken or missing after Golden Retriever restores files\n  componentDidUpdate(): void {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  componentWillUnmount(): void {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleCancelThumbnail(file)\n    }\n  }\n\n  render(): ComponentChild {\n    const { file } = this.props\n\n    const isProcessing = file.progress.preprocess || file.progress.postprocess\n    const isUploaded =\n      !!file.progress.uploadComplete && !isProcessing && !file.error\n    const uploadInProgressOrComplete =\n      !!file.progress.uploadStarted || !!isProcessing\n    const uploadInProgress =\n      (file.progress.uploadStarted && !file.progress.uploadComplete) ||\n      isProcessing\n    const error = file.error || false\n\n    // File that Golden Retriever was able to partly restore (only meta, not blob),\n    // users still need to re-add it, so itâ€™s a ghost\n    const { isGhost } = file\n\n    let showRemoveButton =\n      this.props.individualCancellation ?\n        !isUploaded\n      : !uploadInProgress && !isUploaded\n\n    if (isUploaded && this.props.showRemoveButtonAfterComplete) {\n      showRemoveButton = true\n    }\n\n    const dashboardItemClass = classNames({\n      'uppy-Dashboard-Item': true,\n      'is-inprogress': uploadInProgress && !this.props.recoveredState,\n      'is-processing': isProcessing,\n      'is-complete': isUploaded,\n      'is-error': !!error,\n      'is-resumable': this.props.resumableUploads,\n      'is-noIndividualCancellation': !this.props.individualCancellation,\n      'is-ghost': isGhost,\n    })\n\n    return (\n      <div\n        className={dashboardItemClass}\n        id={`uppy_${file.id}`}\n        role={this.props.role}\n      >\n        <div className=\"uppy-Dashboard-Item-preview\">\n          <FilePreviewAndLink\n            file={file}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            i18n={this.props.i18n}\n            toggleFileCard={this.props.toggleFileCard}\n            metaFields={this.props.metaFields}\n          />\n          <FileProgress<M, B>\n            uppy={this.props.uppy}\n            file={file}\n            error={error}\n            isUploaded={isUploaded}\n            hideRetryButton={this.props.hideRetryButton}\n            hideCancelButton={this.props.hideCancelButton}\n            hidePauseResumeButton={this.props.hidePauseResumeButton}\n            recoveredState={this.props.recoveredState}\n            resumableUploads={this.props.resumableUploads}\n            individualCancellation={this.props.individualCancellation}\n            i18n={this.props.i18n}\n          />\n        </div>\n\n        <div className=\"uppy-Dashboard-Item-fileInfoAndButtons\">\n          <FileInfo\n            file={file}\n            containerWidth={this.props.containerWidth}\n            containerHeight={this.props.containerHeight}\n            i18n={this.props.i18n}\n            toggleAddFilesPanel={this.props.toggleAddFilesPanel}\n            toggleFileCard={this.props.toggleFileCard}\n            metaFields={this.props.metaFields}\n            isSingleFile={this.props.isSingleFile}\n          />\n          <Buttons\n            file={file}\n            metaFields={this.props.metaFields}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            showRemoveButton={showRemoveButton}\n            canEditFile={this.props.canEditFile}\n            uploadInProgressOrComplete={uploadInProgressOrComplete}\n            toggleFileCard={this.props.toggleFileCard}\n            openFileEditor={this.props.openFileEditor}\n            uppy={this.props.uppy}\n            i18n={this.props.i18n}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n"],"mappings":"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","ignoreList":[]}