{"version":3,"names":["h","uploadStates","STATE_ERROR","STATE_WAITING","STATE_PREPROCESSING","STATE_UPLOADING","STATE_POSTPROCESSING","STATE_COMPLETE","STATE_PAUSED","getUploadingState","isAllErrored","isAllComplete","isAllPaused","files","state","fileIDs","Object","keys","i","length","progress","uploadStarted","uploadComplete","preprocess","postprocess","UploadStatus","_ref","i18n","inProgressNotPausedFiles","newFiles","processingFiles","uploadingState","smart_count","PanelTopBar","props","hideCancelButton","maxNumberOfFiles","toggleAddFilesPanel","uppy","allowNewUpload","totalFileCount","className","type","onClick","cancelAll","role","title","focusable","width","height","viewBox","d"],"sources":["PickerPanelTopBar.tsx"],"sourcesContent":["import type { UppyFile } from '@uppy/utils/lib/UppyFile'\nimport { h } from 'preact'\n\ntype $TSFixMe = any\n\nconst uploadStates = {\n  STATE_ERROR: 'error',\n  STATE_WAITING: 'waiting',\n  STATE_PREPROCESSING: 'preprocessing',\n  STATE_UPLOADING: 'uploading',\n  STATE_POSTPROCESSING: 'postprocessing',\n  STATE_COMPLETE: 'complete',\n  STATE_PAUSED: 'paused',\n}\n\nfunction getUploadingState(\n  isAllErrored: $TSFixMe,\n  isAllComplete: $TSFixMe,\n  isAllPaused: $TSFixMe,\n  files: Record<string, UppyFile<any, any>> = {},\n): $TSFixMe {\n  if (isAllErrored) {\n    return uploadStates.STATE_ERROR\n  }\n\n  if (isAllComplete) {\n    return uploadStates.STATE_COMPLETE\n  }\n\n  if (isAllPaused) {\n    return uploadStates.STATE_PAUSED\n  }\n\n  let state = uploadStates.STATE_WAITING\n  const fileIDs = Object.keys(files)\n  for (let i = 0; i < fileIDs.length; i++) {\n    const { progress } = files[fileIDs[i] as keyof typeof files]\n    // If ANY files are being uploaded right now, show the uploading state.\n    if (progress.uploadStarted && !progress.uploadComplete) {\n      return uploadStates.STATE_UPLOADING\n    }\n    // If files are being preprocessed AND postprocessed at this time, we show the\n    // preprocess state. If any files are being uploaded we show uploading.\n    if (progress.preprocess && state !== uploadStates.STATE_UPLOADING) {\n      state = uploadStates.STATE_PREPROCESSING\n    }\n    // If NO files are being preprocessed or uploaded right now, but some files are\n    // being postprocessed, show the postprocess state.\n    if (\n      progress.postprocess &&\n      state !== uploadStates.STATE_UPLOADING &&\n      state !== uploadStates.STATE_PREPROCESSING\n    ) {\n      state = uploadStates.STATE_POSTPROCESSING\n    }\n  }\n  return state\n}\n\nfunction UploadStatus({\n  files,\n  i18n,\n  isAllComplete,\n  isAllErrored,\n  isAllPaused,\n  inProgressNotPausedFiles,\n  newFiles,\n  processingFiles,\n}: $TSFixMe) {\n  const uploadingState = getUploadingState(\n    isAllErrored,\n    isAllComplete,\n    isAllPaused,\n    files,\n  )\n\n  switch (uploadingState) {\n    case 'uploading':\n      return i18n('uploadingXFiles', {\n        smart_count: inProgressNotPausedFiles.length,\n      })\n    case 'preprocessing':\n    case 'postprocessing':\n      return i18n('processingXFiles', { smart_count: processingFiles.length })\n    case 'paused':\n      return i18n('uploadPaused')\n    case 'waiting':\n      return i18n('xFilesSelected', { smart_count: newFiles.length })\n    case 'complete':\n      return i18n('uploadComplete')\n    case 'error':\n      return i18n('error')\n    default:\n  }\n}\n\nfunction PanelTopBar(props: $TSFixMe) {\n  const {\n    i18n,\n    isAllComplete,\n    hideCancelButton,\n    maxNumberOfFiles,\n    toggleAddFilesPanel,\n    uppy,\n  } = props\n  let { allowNewUpload } = props\n  // TODO maybe this should be done in ../Dashboard.jsx, then just pass that down as `allowNewUpload`\n  if (allowNewUpload && maxNumberOfFiles) {\n    // eslint-disable-next-line react/destructuring-assignment\n    allowNewUpload = props.totalFileCount < props.maxNumberOfFiles\n  }\n\n  return (\n    <div className=\"uppy-DashboardContent-bar\">\n      {!isAllComplete && !hideCancelButton ?\n        <button\n          className=\"uppy-DashboardContent-back\"\n          type=\"button\"\n          onClick={() => uppy.cancelAll()}\n        >\n          {i18n('cancel')}\n        </button>\n      : <div />}\n\n      <div\n        className=\"uppy-DashboardContent-title\"\n        role=\"heading\"\n        aria-level=\"1\"\n      >\n        {/* eslint-disable-next-line react/jsx-props-no-spreading */}\n        <UploadStatus {...props} />\n      </div>\n\n      {allowNewUpload ?\n        <button\n          className=\"uppy-DashboardContent-addMore\"\n          type=\"button\"\n          aria-label={i18n('addMoreFiles')}\n          title={i18n('addMoreFiles')}\n          onClick={() => toggleAddFilesPanel(true)}\n        >\n          <svg\n            aria-hidden=\"true\"\n            focusable=\"false\"\n            className=\"uppy-c-icon\"\n            width=\"15\"\n            height=\"15\"\n            viewBox=\"0 0 15 15\"\n          >\n            <path d=\"M8 6.5h6a.5.5 0 0 1 .5.5v.5a.5.5 0 0 1-.5.5H8v6a.5.5 0 0 1-.5.5H7a.5.5 0 0 1-.5-.5V8h-6a.5.5 0 0 1-.5-.5V7a.5.5 0 0 1 .5-.5h6v-6A.5.5 0 0 1 7 0h.5a.5.5 0 0 1 .5.5v6z\" />\n          </svg>\n          <span className=\"uppy-DashboardContent-addMoreCaption\">\n            {i18n('addMore')}\n          </span>\n        </button>\n      : <div />}\n    </div>\n  )\n}\n\nexport default PanelTopBar\n"],"mappings":"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","ignoreList":[]}