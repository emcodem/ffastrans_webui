{"version":3,"names":["cloneElement","toChildArray","useEffect","useState","useRef","classNames","transitionName","duration","Slide","_ref","children","cachedChildren","setCachedChildren","className","setClassName","enterTimeoutRef","leaveTimeoutRef","animationFrameRef","handleEnterTransition","cancelAnimationFrame","current","clearTimeout","undefined","requestAnimationFrame","setTimeout","handleLeaveTransition","child","props"],"sources":["Slide.tsx"],"sourcesContent":["import {\n  cloneElement,\n  toChildArray,\n  type VNode,\n  type ComponentChildren,\n} from 'preact'\nimport { useEffect, useState, useRef } from 'preact/hooks'\nimport classNames from 'classnames'\n\nconst transitionName = 'uppy-transition-slideDownUp'\nconst duration = 250\n\n/**\n * Vertical slide transition.\n *\n * This can take a _single_ child component, which _must_ accept a `className` prop.\n *\n * Currently this is specific to the `uppy-transition-slideDownUp` transition,\n * but it should be simple to extend this for any type of single-element\n * transition by setting the CSS name and duration as props.\n */\nfunction Slide({ children }: { children: ComponentChildren }) {\n  const [cachedChildren, setCachedChildren] = useState<VNode<{\n    className?: string\n  }> | null>(null)\n  const [className, setClassName] = useState('')\n  const enterTimeoutRef = useRef<ReturnType<typeof setTimeout>>()\n  const leaveTimeoutRef = useRef<ReturnType<typeof setTimeout>>()\n  const animationFrameRef = useRef<ReturnType<typeof requestAnimationFrame>>()\n\n  const handleEnterTransition = () => {\n    setClassName(`${transitionName}-enter`)\n\n    cancelAnimationFrame(animationFrameRef.current!)\n    clearTimeout(leaveTimeoutRef.current)\n    leaveTimeoutRef.current = undefined\n\n    animationFrameRef.current = requestAnimationFrame(() => {\n      setClassName(`${transitionName}-enter ${transitionName}-enter-active`)\n\n      enterTimeoutRef.current = setTimeout(() => {\n        setClassName('')\n      }, duration)\n    })\n  }\n\n  const handleLeaveTransition = () => {\n    setClassName(`${transitionName}-leave`)\n\n    cancelAnimationFrame(animationFrameRef.current!)\n    clearTimeout(enterTimeoutRef.current)\n    enterTimeoutRef.current = undefined\n\n    animationFrameRef.current = requestAnimationFrame(() => {\n      setClassName(`${transitionName}-leave ${transitionName}-leave-active`)\n\n      leaveTimeoutRef.current = setTimeout(() => {\n        setCachedChildren(null)\n        setClassName('')\n      }, duration)\n    })\n  }\n\n  useEffect(() => {\n    const child = toChildArray(children)[0] as VNode\n    if (cachedChildren === child) return\n\n    if (child && !cachedChildren) {\n      handleEnterTransition()\n    } else if (cachedChildren && !child && !leaveTimeoutRef.current) {\n      handleLeaveTransition()\n    }\n\n    setCachedChildren(child)\n  }, [children, cachedChildren]) // Dependency array to trigger effect on children change\n\n  useEffect(() => {\n    return () => {\n      clearTimeout(enterTimeoutRef.current)\n      clearTimeout(leaveTimeoutRef.current)\n      cancelAnimationFrame(animationFrameRef.current!)\n    }\n  }, []) // Cleanup useEffect\n\n  if (!cachedChildren) return null\n\n  return cloneElement(cachedChildren, {\n    className: classNames(className, cachedChildren.props.className),\n  })\n}\n\nexport default Slide\n"],"mappings":"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","ignoreList":[]}